<html>
<head>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #171819;
}
</style>
<script type="text/javascript" src="Utility.js"></script>
<script type="text/javascript" src="Timer.js"></script>
<script type="text/javascript" src="Pie.js"></script>
</head>
<body>
<canvas id="canvas"></canvas>
<script>

var canvas = document.getElementById('canvas'),
		ctx = canvas.getContext('2d'),
		window_width = window.innerWidth,
		window_height = window.innerHeight;

canvas.width = window_width;
canvas.height = window_height;



var now,
		then = new Date().getTime(),
		delta;


var timer = new Timer(
function(x){

if(x>100){
this.increment = false;
console.log("precallback " + x);

}
},
function(x){

if(x<0){
this.increment = true;
console.log("postcallback " + x);
}
}
);
timer.rate = 0.1;
timer.enabled = true;

var circle = {
	// Basic attributes
	x: 150,
	y: 150,
	radius: 50,
	color: "white",
	
	// Function to draw the circle
	draw : function() {
		ctx.beginPath();
		ctx.fillStyle = this.color;
		ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2, false);
		ctx.closePath();
		ctx.fill();
	}
};


var pie = new Pie();
// Now moving it
function move() {
	now = new Date().getTime();
	delta = now - then;
	
	timer.tick(delta);
	
	ctx.clearRect(0, 0, window_width, window_height);
	ctx.font = "24px Verdana";
	//var c = circle;
	//c.draw();
	pie.render(ctx,delta);
	
	ctx.fillText(timer.value, 10, 30);
	//c.x += calcSpeed(delta, 1);
	pie.x += calcSpeed(delta,1);
	if(pie.x - pie.radius > window_width)
		{pie.x = -pie.radius;}
	
		
	
	
	
	then = now;
}
function degreesToRadians(degrees) {
    return (degrees * Math.PI)/180;
}

var calcSpeed = function(del, speed) {
	return (speed * 60 * del) / 1000;
}

var animloop = function() {
	
	move();
	requestAnimationFrame(animloop);
};

animloop();
</script>
</body>
</html>